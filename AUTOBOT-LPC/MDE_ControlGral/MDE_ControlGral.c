/*******************************************************************************************************************************//**
 *
 * @file		MDE_ControlGral.c
 * @brief		Modulo para el manejo total del auto
 * @date		25/02/21
 * @author		Andres Yang, Luis Gindre, Uriel Mayo
 **********************************************************************************************************************************/

/*********************************************************************************************************************************
*** MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** INCLUDES
**********************************************************************************************************************************/
#include "MDE_ControlGral.h"
#include "MDE_workMode.h"
#include "MDE_creativeMode.h"
#include "Flags.h"
#include "DR_LED.h"

/*********************************************************************************************************************************
 *** DEFINES PRIVADOS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** MACROS PRIVADAS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** TIPOS DE DATOS PRIVADOS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** TABLAS PRIVADAS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** VARIABLES GLOBALES PUBLICAS
**********************************************************************************************************************************/
/*********************************************************************************************************************************
 *** VARIABLES GLOBALES PRIVADAS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** PROTOTIPO DE FUNCIONES PRIVADAS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** FUNCIONES PRIVADAS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** FUNCIONES GLOBALES AL MODULO
**********************************************************************************************************************************/
void maquina_MdE_ControlAutobot()
{
	static int estado = ESPERANDO_MODO;

	switch(estado){
	case ESPERANDO_MODO:
		if( modoFuncionamiento == MODO_AUTONOMO){
			estado = MODO_AUTONOMO;
			switch_on_LED(LED_RED);
			switch_on_LED(LED_YELLOW);
		}
		if( modoFuncionamiento == MODO_CREATIVO){
			estado = MODO_CREATIVO;
			switch_on_LED(LED_YELLOW);
			switch_on_LED(LED_GREEN);
		}
//		if( carErrorFlg == TRUE)
//		{
//
//			apagarLeds( );
//			encenderLedRojo( );
//			encenderLedAmarillo( );
//			encenderLedVerde( );
//
//			estado = ERROR;
//		}
		break;
	case MODO_AUTONOMO:
		if( modoFuncionamiento == ESPERANDO_MODO){
			estado = ESPERANDO_MODO;
			switch_off_all_LEDs();
		}
		else{
			MDE_workMode();
		}
		break;
	case MODO_CREATIVO:
		if( modoFuncionamiento != MODO_CREATIVO){
			switch_off_all_LEDs();
			estado = ESPERANDO_MODO;
		}
		else{
			MDE_creativeMode();
		}
//		if(carErrorFlg == TRUE)
//		{
//			apagarMotores();
//			apagarLeds();
//			encenderLedRojo();
//			encenderLedAmarillo();
//			encenderLedVerde();
//			MostrarError();
//
//			estado = ERROR;
//		}
		break;
	case ERROR:
		break;
	default: estado = ESPERANDO_MODO;
	}
}
/***********************************************************************************************************************************
 *** FIN DEL MODULO
 **********************************************************************************************************************************/

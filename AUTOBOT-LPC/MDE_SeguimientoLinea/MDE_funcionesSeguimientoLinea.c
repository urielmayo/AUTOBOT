/*******************************************************************************************************************************//**
 *
 * @file		MDE_funcionesSeguimientoLinea.c
 * @brief		Modulo para el manejo wifi
 * @date		25/02/21
 * @author		Andres Yang, Luis Gindre, Uriel Mayo
 **********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** INCLUDES
**********************************************************************************************************************************/
#include "MDE_funcionesSeguimientoLinea.h"
#include "Flags.h"
#include "PR_motor.h"

#include "DR_sensorInfrarojo.h"

/*********************************************************************************************************************************
 *** DEFINES PRIVADOS AL MODULO
**********************************************************************************************************************************/
#define MDE_SPEED 150
#define MDE_SPEED_TURN 150
/*********************************************************************************************************************************
 *** MACROS PRIVADAS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** TIPOS DE DATOS PRIVADOS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** TABLAS PRIVADAS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** VARIABLES GLOBALES PUBLICAS
**********************************************************************************************************************************/
/*********************************************************************************************************************************
 *** VARIABLES GLOBALES PRIVADAS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** PROTOTIPO DE FUNCIONES PRIVADAS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** FUNCIONES PRIVADAS AL MODULO
**********************************************************************************************************************************/

/*********************************************************************************************************************************
 *** FUNCIONES GLOBALES AL MODULO
**********************************************************************************************************************************/

int SensorLineaDerActivado( void )
{
	return getRightSensorStatus();
}

int SensorCentralActivado()
{
	return getMiddleSensorStatus();
}

int SensorLineaIzqActivado( void )
{
	return getLeftSensorStatus();
}

void avanzar( void )
{
	motor_forward(MDE_SPEED);
}

void girarIzq(uint8_t mode)
{
	motor_turn(MDE_SPEED_TURN,TURN_LEFT,mode);
}

void girarDer( uint8_t mode )
{
	motor_turn(MDE_SPEED_TURN,TURN_RIGHT,mode);
}

void checkearPerdido()
{
	if(SensorLineaDerActivado() && SensorLineaIzqActivado()){ // perdido
		lostDelayFlag = true;
		if(lostFlag){
			motor_stop();
			rideStatus = LOST;
		}
	}
	else{
		lostDelayFlag = false;
	}
}

uint8_t checkearFinal()
{
	if(!SensorLineaDerActivado() && !SensorLineaIzqActivado() && SensorCentralActivado()){ // termino
		return 1;
	}
	else{
		endFlag = false;
		return 0;
	}
}

/***********************************************************************************************************************************
 *** FIN DEL MODULO
 **********************************************************************************************************************************/
